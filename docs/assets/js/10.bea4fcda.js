(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{486:function(s,t,a){s.exports=a.p+"assets/img/image-20200529111423863.32295a98.png"},504:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"nacos集群部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nacos集群部署"}},[s._v("#")]),s._v(" Nacos集群部署")]),s._v(" "),n("h2",{attrs:{id:"一、部署架构图"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、部署架构图"}},[s._v("#")]),s._v(" 一、部署架构图")]),s._v(" "),n("h3",{attrs:{id:"_1、部署架构图"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、部署架构图"}},[s._v("#")]),s._v(" 1、部署架构图")]),s._v(" "),n("p",[n("img",{attrs:{src:a(486),alt:"image-20200529111423863"}})]),s._v(" "),n("h3",{attrs:{id:"_2、主机规划"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、主机规划"}},[s._v("#")]),s._v(" 2、主机规划")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[s._v("节点")]),s._v(" "),n("th",{staticStyle:{"text-align":"center"}},[s._v("端口")]),s._v(" "),n("th",{staticStyle:{"text-align":"center"}},[s._v("备注")])])]),s._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("10.1.103.171")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("8848")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("nacos")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("10.1.103.172")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("8848")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("nacos")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("10.1.103.173")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("8848")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("nacos")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("Mysql (10.1.103.171)")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("3306")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("mysql 主数据库")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("Mysql (10.1.103.172)")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("3306")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("mysql 备数据库")])])])]),s._v(" "),n("h2",{attrs:{id:"二、部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、部署"}},[s._v("#")]),s._v(" 二、部署")]),s._v(" "),n("p",[s._v("将nacos文件安装包分别放在三台机器上，解压")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/alibaba/nacos/releases/download/1.2.1/nacos-server-1.2.1.tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -xzvf nacos-server-1.2.1.tar.gz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_1、准备数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、准备数据库"}},[s._v("#")]),s._v(" 1、准备数据库")]),s._v(" "),n("blockquote",[n("p",[s._v("在"),n("code",[s._v("171")]),s._v(" 、"),n("code",[s._v("172")]),s._v(" 两台主机上安装mysql数据库，我这里使用的是docker安装，安装完成将上述解压后的 "),n("code",[s._v("nacos-server")]),s._v(" 文件下的 "),n("code",[s._v("conf")]),s._v("文件夹中，执行 "),n("code",[s._v("nacos-mysql.sql")]),s._v(" 文件，完成nacos数据库的搭建。")])]),s._v(" "),n("h3",{attrs:{id:"_2、修改配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、修改配置文件"}},[s._v("#")]),s._v(" 2、修改配置文件")]),s._v(" "),n("p",[s._v("修改 "),n("code",[s._v("appication.properties")]),s._v(" 配置文件，添加以下内容")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表明用MySQL作为后端存储")]),s._v("\nspring.datasource.platform"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 有几个数据库实例")]),s._v("\ndb.num"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第1个实例的地址")]),s._v("\ndb.url.0"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("jdbc:mysql://10.1.103.171:3306/nacos_config?characterEncoding"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connectTimeout")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socketTimeout")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("autoReconnect")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第2个实例的地址")]),s._v("\ndb.url.1"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("jdbc:mysql://10.1.103.172:3306/nacos_config?characterEncoding"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connectTimeout")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socketTimeout")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("autoReconnect")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\ndb.user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\ndb.password"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("重命名 "),n("code",[s._v("cluster.conf.example")]),s._v(" 修改nacos IP")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".103.171:8848\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".103.172:8848\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".103.173:8848\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"_3、启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、启动"}},[s._v("#")]),s._v(" 3、启动")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动命名脚本")]),s._v("\n./bin/startup.sh\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭命令脚本")]),s._v("\n./bin/shutdown.sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"三、配置nginx负载均衡"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、配置nginx负载均衡"}},[s._v("#")]),s._v(" 三、配置nginx负载均衡")]),s._v(" "),n("h3",{attrs:{id:"_1、编辑nginx配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、编辑nginx配置文件"}},[s._v("#")]),s._v(" 1、编辑nginx配置文件")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" nacos-nginx.conf\nuser root"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nworker_processes  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nevents "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    worker_connections  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nhttp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    upstream nacos "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".103.171:8848"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n         server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".103.172:8848"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n         server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".103.173:8848"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n   server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          listen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          server_name  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".103.173"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          location /nacos/ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n             proxy_pass http://nacos/nacos/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h3",{attrs:{id:"_2、启动nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、启动nginx"}},[s._v("#")]),s._v(" 2、启动nginx")]),s._v(" "),n("p",[s._v("我这里使用的docker 容器启动")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("docker run -d --restart"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unless-stopped "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -v /home/nacosServer/nginx/nacos-nginx.conf:/etc/nginx/nginx.conf "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  microid.docker.com:5000/nginx:latest\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"_3、启动成功后访问"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、启动成功后访问"}},[s._v("#")]),s._v(" 3、启动成功后访问")]),s._v(" "),n("p",[s._v("访问 "),n("code",[s._v("10.1.103.171/nacos")])])])}),[],!1,null,null,null);t.default=e.exports}}]);